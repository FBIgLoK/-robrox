-- SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera

local LocalPlayer = Players.LocalPlayer

-- CONFIG
local AIM_PART = "Head"
local SMOOTHNESS = 0.12
local FOV_RADIUS = 150 -- área do centro da tela

-- FUNÇÃO: alvo mais próximo do centro da tela
local function getClosestTarget()
	local closestPart = nil
	local shortestDistance = FOV_RADIUS

	local viewportCenter = Vector2.new(
		Camera.ViewportSize.X / 2,
		Camera.ViewportSize.Y / 2
	)

	for _, player in pairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Character then
			local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
			local part = player.Character:FindFirstChild(AIM_PART)

			if humanoid and humanoid.Health > 0 and part then
				local screenPos, onScreen = Camera:WorldToViewportPoint(part.Position)

				if onScreen then
					local dist = (Vector2.new(screenPos.X, screenPos.Y) - viewportCenter).Magnitude

					if dist < shortestDistance then
						shortestDistance = dist
						closestPart = part
					end
				end
			end
		end
	end

	return closestPart
end

-- LOOP
RunService.RenderStepped:Connect(function()
	local target = getClosestTarget()

	if target then
		local camPos = Camera.CFrame.Position
		local aimCFrame = CFrame.new(camPos, target.Position)

		Camera.CFrame = Camera.CFrame:Lerp(aimCFrame, SMOOTHNESS)
	end
end)
