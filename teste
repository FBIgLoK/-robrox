local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera

local LocalPlayer = Players.LocalPlayer

local AIM_PART = "Head"
local FOV_RADIUS = 200
local MAX_DISTANCE = 1000

-- centro da tela
local function getCenter()
	return Vector2.new(
		Camera.ViewportSize.X / 2,
		Camera.ViewportSize.Y / 2
	)
end

-- pega o alvo mais prÃ³ximo do centro
local function getClosestTarget()
	local closest = nil
	local shortest = FOV_RADIUS
	local center = getCenter()

	for _, player in pairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Character then
			local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
			local head = player.Character:FindFirstChild(AIM_PART)
			local root = player.Character:FindFirstChild("HumanoidRootPart")

			if humanoid and humanoid.Health > 0 and head and root then
				if (Camera.CFrame.Position - root.Position).Magnitude <= MAX_DISTANCE then
					local pos, onScreen = Camera:WorldToViewportPoint(head.Position)
					if onScreen then
						local dist = (Vector2.new(pos.X, pos.Y) - center).Magnitude
						if dist < shortest then
							shortest = dist
							closest = head
						end
					end
				end
			end
		end
	end

	return closest
end

-- LOOP
RunService.RenderStepped:Connect(function()
	local target = getClosestTarget()
	if target then
		local camPos = Camera.CFrame.Position
		Camera.CFrame = CFrame.new(camPos, target.Position)
	end
end)
