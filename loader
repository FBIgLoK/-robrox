local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local localPlayer = Players.LocalPlayer
local playerGui = localPlayer:WaitForChild("PlayerGui")

-- Criar ScreenGui principal do menu
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MenuGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Frame principal do menu
local frame = Instance.new("Frame")
frame.Name = "MenuFrame"
frame.Size = UDim2.new(0, 500, 0, 300)
frame.AnchorPoint = Vector2.new(0.5, 0.5)
frame.Position = UDim2.new(0.5, 0, 0.5, 0)
frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
frame.BackgroundTransparency = 0.1
frame.BorderSizePixel = 0
frame.Parent = screenGui

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 10)
uiCorner.Parent = frame

-- Título do menu
local title = Instance.new("TextButton")
title.Name = "Title"
title.Text = "Fbi UwU HUB"
title.Size = UDim2.new(1, -50, 0, 40)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 24
title.TextScaled = false
title.Parent = frame

-- Drag functionality
local dragging = false
local dragStart = nil
local startPos = nil

title.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = frame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

title.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		if dragging then
			local delta = input.Position - dragStart
			frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end
end)

-- Botão de minimizar
local minimizeButton = Instance.new("TextButton")
minimizeButton.Name = "MinimizeButton"
minimizeButton.Text = "-"
minimizeButton.Size = UDim2.new(0, 40, 0, 40)
minimizeButton.Position = UDim2.new(1, -40, 0, 0)
minimizeButton.BackgroundTransparency = 1
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.Font = Enum.Font.SourceSansBold
minimizeButton.TextSize = 24
minimizeButton.Parent = frame

-- Botão de restaurar (inicialmente invisível)
local restoreButton = Instance.new("TextButton")
restoreButton.Name = "RestoreButton"
restoreButton.Text = "UwU"
restoreButton.Size = UDim2.new(0, 80, 0, 30)
restoreButton.AnchorPoint = Vector2.new(0.5, 0.5)
restoreButton.Position = UDim2.new(0.5, 0, 0.05, 0)
restoreButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
restoreButton.BackgroundTransparency = 0.2
restoreButton.TextColor3 = Color3.fromRGB(255, 255, 255)
restoreButton.Font = Enum.Font.SourceSansBold
restoreButton.TextSize = 24
restoreButton.Visible = false
restoreButton.Parent = screenGui

local restoreCorner = Instance.new("UICorner")
restoreCorner.CornerRadius = UDim.new(1, 0)
restoreCorner.Parent = restoreButton

-- Função para minimizar
minimizeButton.MouseButton1Click:Connect(function()
	frame.Visible = false
	restoreButton.Visible = true
end)

-- Função para restaurar
restoreButton.MouseButton1Click:Connect(function()
	frame.Visible = true
	restoreButton.Visible = false
end)

-- Linha roxa abaixo do título
local thinLine = Instance.new("Frame")
thinLine.Name = "ThinLine"
thinLine.Size = UDim2.new(1, 0, 0, 2)
thinLine.Position = UDim2.new(0, 0, 0, 40)
thinLine.BackgroundColor3 = Color3.fromRGB(128, 0, 128)
thinLine.BorderSizePixel = 0
thinLine.Parent = frame

-- Sidebar
local sidebar = Instance.new("Frame")
sidebar.Name = "Sidebar"
sidebar.Size = UDim2.new(0, 150, 1, -52)
sidebar.Position = UDim2.new(0, 0, 0, 52)
sidebar.BackgroundTransparency = 1
sidebar.Parent = frame

-- Aba Perfil
local perfilButton = Instance.new("TextButton")
perfilButton.Name = "PerfilButton"
perfilButton.Size = UDim2.new(1, -20, 0, 40)
perfilButton.Position = UDim2.new(0, 10, 0, 10)
perfilButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
perfilButton.BackgroundTransparency = 1
perfilButton.BorderSizePixel = 0
perfilButton.TextColor3 = Color3.fromRGB(255, 255, 255)
perfilButton.Font = Enum.Font.SourceSans
perfilButton.TextSize = 20
perfilButton.Text = ""
perfilButton.TextXAlignment = Enum.TextXAlignment.Left
perfilButton.Parent = sidebar

local contentHolder = Instance.new("Frame")
contentHolder.Name = "ContentHolder"
contentHolder.Size = UDim2.new(1, 0, 1, 0)
contentHolder.BackgroundTransparency = 1
contentHolder.Parent = perfilButton

local listLayout = Instance.new("UIListLayout")
listLayout.FillDirection = Enum.FillDirection.Horizontal
listLayout.VerticalAlignment = Enum.VerticalAlignment.Center
listLayout.Padding = UDim.new(0, 8)
listLayout.Parent = contentHolder

local perfilText = Instance.new("TextLabel")
perfilText.Name = "PerfilText"
perfilText.Size = UDim2.new(1, 0, 1, 0)
perfilText.BackgroundTransparency = 1
perfilText.Text = "Perfil"
perfilText.TextColor3 = Color3.fromRGB(255, 255, 255)
perfilText.Font = Enum.Font.SourceSans
perfilText.TextSize = 20
perfilText.TextXAlignment = Enum.TextXAlignment.Left
perfilText.Parent = contentHolder

-- Área de conteúdo
local content = Instance.new("Frame")
content.Name = "Content"
content.Size = UDim2.new(1, -150, 1, -52)
content.Position = UDim2.new(0, 150, 0, 52)
content.BackgroundTransparency = 1
content.Parent = frame

-- Separador vertical
local separator = Instance.new("Frame")
separator.Name = "Separator"
separator.Size = UDim2.new(0, 2, 1, -52)
separator.Position = UDim2.new(0, 150, 0, 52)
separator.BackgroundColor3 = Color3.fromRGB(128, 0, 128)
separator.BorderSizePixel = 0
separator.Parent = frame

-- Aba Perfil
local perfilTab = Instance.new("Frame")
perfilTab.Name = "PerfilTab"
perfilTab.Size = UDim2.new(1, 0, 1, 0)
perfilTab.BackgroundTransparency = 1
perfilTab.Visible = true
perfilTab.Parent = content

local perfilLabel = Instance.new("TextLabel")
perfilLabel.Name = "PerfilLabel"
perfilLabel.Text = "Bem-vindo ao seu Perfil"
perfilLabel.Size = UDim2.new(1, -20, 0, 30)
perfilLabel.Position = UDim2.new(0, 10, 0, 10)
perfilLabel.BackgroundTransparency = 1
perfilLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
perfilLabel.Font = Enum.Font.SourceSans
perfilLabel.TextSize = 20
perfilLabel.Parent = perfilTab

-- Botão AIM (novo)
local newAIMButton = Instance.new("TextButton")
newAIMButton.Name = "NewAIMButton"
newAIMButton.Size = UDim2.new(1, -20, 0, 40)
newAIMButton.Position = UDim2.new(0, 10, 0, 60)
newAIMButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
newAIMButton.BackgroundTransparency = 1
newAIMButton.BorderSizePixel = 0
newAIMButton.TextColor3 = Color3.fromRGB(255, 255, 255)
newAIMButton.Font = Enum.Font.SourceSans
newAIMButton.TextSize = 20
newAIMButton.Text = ""
newAIMButton.TextXAlignment = Enum.TextXAlignment.Left
newAIMButton.Parent = sidebar

local newAIMHolder = Instance.new("Frame")
newAIMHolder.Name = "NewAIMHolder"
newAIMHolder.Size = UDim2.new(1, 0, 1, 0)
newAIMHolder.Position = UDim2.new(0, 0, 0, 0)
newAIMHolder.BackgroundTransparency = 1
newAIMHolder.Parent = newAIMButton

local newAIMLayout = Instance.new("UIListLayout")
newAIMLayout.FillDirection = Enum.FillDirection.Horizontal
newAIMLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
newAIMLayout.VerticalAlignment = Enum.VerticalAlignment.Center
newAIMLayout.Padding = UDim.new(0, 8)
newAIMLayout.Parent = newAIMHolder

local newAIMText = Instance.new("TextLabel")
newAIMText.Name = "NewAIMText"
newAIMText.Size = UDim2.new(1, 0, 1, 0)
newAIMText.BackgroundTransparency = 1
newAIMText.Text = "AIM"
newAIMText.TextColor3 = Color3.fromRGB(255, 255, 255)
newAIMText.Font = Enum.Font.SourceSans
newAIMText.TextSize = 20
newAIMText.TextXAlignment = Enum.TextXAlignment.Left
newAIMText.Parent = newAIMHolder

-- Botão ESP
local espButton = Instance.new("TextButton")
espButton.Name = "ESPButton"
espButton.Size = UDim2.new(1, -20, 0, 40)
espButton.Position = UDim2.new(0, 10, 0, 110)
espButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
espButton.BackgroundTransparency = 1
espButton.BorderSizePixel = 0
espButton.TextColor3 = Color3.fromRGB(255, 255, 255)
espButton.Font = Enum.Font.SourceSans
espButton.TextSize = 20
espButton.Text = ""
espButton.TextXAlignment = Enum.TextXAlignment.Left
espButton.Parent = sidebar

-- Ícone e texto do botão ESP
local espHolder = Instance.new("Frame")
espHolder.Name = "ESPHolder"
espHolder.Size = UDim2.new(1, 0, 1, 0)
espHolder.Position = UDim2.new(0, 0, 0, 0)
espHolder.BackgroundTransparency = 1
espHolder.Parent = espButton

local espLayout = Instance.new("UIListLayout")
espLayout.FillDirection = Enum.FillDirection.Horizontal
espLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
espLayout.VerticalAlignment = Enum.VerticalAlignment.Center
espLayout.Padding = UDim.new(0, 8)
espLayout.Parent = espHolder

local espText = Instance.new("TextLabel")
espText.Name = "ESPText"
espText.Size = UDim2.new(1, 0, 1, 0)
espText.BackgroundTransparency = 1
espText.Text = "ESP"
espText.TextColor3 = Color3.fromRGB(255, 255, 255)
espText.Font = Enum.Font.SourceSans
espText.TextSize = 20
espText.TextXAlignment = Enum.TextXAlignment.Left
espText.Parent = espHolder

-- Botão AIM
local aimButton = Instance.new("TextButton")
aimButton.Name = "AIMButton"
aimButton.Size = UDim2.new(1, -20, 0, 40)
aimButton.Position = UDim2.new(0, 10, 0, 210)
aimButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
aimButton.BackgroundTransparency = 1
aimButton.BorderSizePixel = 0
aimButton.TextColor3 = Color3.fromRGB(255, 255, 255)
aimButton.Font = Enum.Font.SourceSans
aimButton.TextSize = 20
aimButton.Text = ""
aimButton.TextXAlignment = Enum.TextXAlignment.Left
aimButton.Parent = sidebar

-- Ícone e texto do botão AIM
local aimHolder = Instance.new("Frame")
aimHolder.Name = "AIMHolder"
aimHolder.Size = UDim2.new(1, 0, 1, 0)
aimHolder.Position = UDim2.new(0, 0, 0, 0)
aimHolder.BackgroundTransparency = 1
aimHolder.Parent = aimButton

local aimLayout = Instance.new("UIListLayout")
aimLayout.FillDirection = Enum.FillDirection.Horizontal
aimLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
aimLayout.VerticalAlignment = Enum.VerticalAlignment.Center
aimLayout.Padding = UDim.new(0, 8)
aimLayout.Parent = aimHolder

local aimText = Instance.new("TextLabel")
aimText.Name = "AIMText"
aimText.Size = UDim2.new(1, 0, 1, 0)
aimText.BackgroundTransparency = 1
aimText.Text = "Troll"
aimText.TextColor3 = Color3.fromRGB(255, 255, 255)
aimText.Font = Enum.Font.SourceSans
aimText.TextSize = 20
aimText.TextXAlignment = Enum.TextXAlignment.Left
aimText.Parent = aimHolder

-- Botão Player
local playerButton = Instance.new("TextButton")
playerButton.Name = "PlayerButton"
playerButton.Size = UDim2.new(1, -20, 0, 40)
playerButton.Position = UDim2.new(0, 10, 0, 160)
playerButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
playerButton.BackgroundTransparency = 1
playerButton.BorderSizePixel = 0
playerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
playerButton.Font = Enum.Font.SourceSans
playerButton.TextSize = 20
playerButton.Text = ""
playerButton.TextXAlignment = Enum.TextXAlignment.Left
playerButton.Parent = sidebar

-- Ícone e texto do botão Player
local playerHolder = Instance.new("Frame")
playerHolder.Name = "PlayerHolder"
playerHolder.Size = UDim2.new(1, 0, 1, 0)
playerHolder.Position = UDim2.new(0, 0, 0, 0)
playerHolder.BackgroundTransparency = 1
playerHolder.Parent = playerButton

local playerLayout = Instance.new("UIListLayout")
playerLayout.FillDirection = Enum.FillDirection.Horizontal
playerLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
playerLayout.VerticalAlignment = Enum.VerticalAlignment.Center
playerLayout.Padding = UDim.new(0, 8)
playerLayout.Parent = playerHolder

local playerText = Instance.new("TextLabel")
playerText.Name = "PlayerText"
playerText.Size = UDim2.new(1, 0, 1, 0)
playerText.BackgroundTransparency = 1
playerText.Text = "Player"
playerText.TextColor3 = Color3.fromRGB(255, 255, 255)
playerText.Font = Enum.Font.SourceSans
playerText.TextSize = 20
playerText.TextXAlignment = Enum.TextXAlignment.Left
playerText.Parent = playerHolder

-- Aba ESP
local espTab = Instance.new("Frame")
espTab.Name = "ESPTab"
espTab.Size = UDim2.new(1, 0, 1, 0)
espTab.BackgroundTransparency = 1
espTab.Visible = false
espTab.Parent = content

local espTitle = Instance.new("TextLabel")
espTitle.Name = "ESPTitle"
espTitle.Text = "ESP Configurações"
espTitle.Size = UDim2.new(1, -20, 0, 30)
espTitle.Position = UDim2.new(0, 10, 0, 10)
espTitle.BackgroundTransparency = 1
espTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
espTitle.Font = Enum.Font.SourceSans
espTitle.TextSize = 20
espTitle.Parent = espTab

-- Função helper para criar toggles
local function createToggleRow(parent, y, labelText, varName, updateFuncName)
	local row = Instance.new("Frame")
	row.Size = UDim2.new(1, -20, 0, 36)
	row.Position = UDim2.new(0, 10, 0, y)
	row.BackgroundTransparency = 1
	row.Parent = parent

	local lbl = Instance.new("TextLabel")
	lbl.Name = "Label"
	lbl.Size = UDim2.new(1, -70, 1, 0)
	lbl.BackgroundTransparency = 1
	lbl.Text = labelText
	lbl.TextColor3 = Color3.fromRGB(255,255,255)
	lbl.Font = Enum.Font.SourceSans
	lbl.TextSize = 18
	lbl.TextXAlignment = Enum.TextXAlignment.Left
	lbl.Parent = row

	local toggle = Instance.new("TextButton")
	toggle.Name = "Toggle"
	toggle.Size = UDim2.new(0, 50, 0, 24)
	toggle.Position = UDim2.new(1, -60, 0.5, -12)
	toggle.BackgroundColor3 = Color3.fromRGB(60,60,60)
	toggle.BorderSizePixel = 0
	toggle.Text = ""
	toggle.Parent = row

	local toggleCorner = Instance.new("UICorner")
	toggleCorner.CornerRadius = UDim.new(0, 12)
	toggleCorner.Parent = toggle

	local knob = Instance.new("Frame")
	knob.Name = "Knob"
	knob.Size = UDim2.new(0, 20, 0, 20)
	knob.Position = UDim2.new(0, 2, 0.5, -10)
	knob.BackgroundColor3 = Color3.fromRGB(200,200,200)
	knob.BorderSizePixel = 0
	knob.Parent = toggle

	local knobCorner = Instance.new("UICorner")
	knobCorner.CornerRadius = UDim.new(1, 0)
	knobCorner.Parent = knob

	local function updateVisual(state)
		local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
		if state then
			TweenService:Create(toggle, tweenInfo, {BackgroundColor3 = Color3.fromRGB(128, 0, 128)}):Play()
			TweenService:Create(knob, tweenInfo, {Position = UDim2.new(1, -22, 0.5, -10), BackgroundColor3 = Color3.fromRGB(255,255,255)}):Play()
		else
			TweenService:Create(toggle, tweenInfo, {BackgroundColor3 = Color3.fromRGB(60,60,60)}):Play()
			TweenService:Create(knob, tweenInfo, {Position = UDim2.new(0, 2, 0.5, -10), BackgroundColor3 = Color3.fromRGB(200,200,200)}):Play()
		end
	end

	local initState = false
	if _G[varName] ~= nil then initState = _G[varName] end
	updateVisual(initState)

	toggle.MouseButton1Click:Connect(function()
		initState = not initState
		_G[varName] = initState
		updateVisual(initState)
		if updateFuncName and type(_G[updateFuncName]) == "function" then
			pcall(_G[updateFuncName])
		end
	end)
end

-- Function to update Master ESP
_G.UpdateMasterESP = function()
	if _G.MasterESP then
		-- Enable ESP
		local function criarESP(model)
			local function aplicar(character)
				if character:FindFirstChild("ESPHighlight") then return end

				local highlight = Instance.new("Highlight")
				highlight.Name = "ESPHighlight"
				highlight.FillColor = Color3.fromRGB(255, 0, 0)
				highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
				highlight.FillTransparency = 0.5
				highlight.OutlineTransparency = 0
				highlight.Adornee = character
				highlight.Parent = character
			end

			if model:IsA("Player") then
				-- Aplica caso o character já exista
				if model.Character then
					aplicar(model.Character)
				end

				-- Aplica quando o character aparecer (respawn)
				model.CharacterAdded:Connect(aplicar)
			else
				-- Para entidades (models)
				aplicar(model)
			end
		end

		-- Aplica ESP para todos os players existentes
		for _, player in pairs(Players:GetPlayers()) do
			criarESP(player)
		end

		-- Aplica ESP para players que entrarem depois
		Players.PlayerAdded:Connect(criarESP)

		-- Aplica ESP para entidades se ESP Entidade ativo
		if _G.ESPEntity then
			for _, model in pairs(workspace:GetDescendants()) do
				if model:IsA("Model") and model ~= localPlayer.Character then
					local humanoid = model:FindFirstChildOfClass("Humanoid")
					if humanoid and humanoid.Health > 0 then
						criarESP(model)
					end
				end
			end
		end
	else
		-- Disable ESP
		for _, player in pairs(Players:GetPlayers()) do
			if player.Character and player.Character:FindFirstChild("ESPHighlight") then
				player.Character.ESPHighlight:Destroy()
			end
		end

		-- Disable ESP for entities
		for _, model in pairs(workspace:GetDescendants()) do
			if model:IsA("Model") and model:FindFirstChild("ESPHighlight") then
				model.ESPHighlight:Destroy()
			end
		end
	end
end

-- Function to update ESP Name
_G.UpdateESPName = function()
	if _G.ESPName then
		-- Enable ESP Name
		local existingGui = game.Players.LocalPlayer:WaitForChild("PlayerGui"):FindFirstChild("ESP_Name_GUI")
		if existingGui then existingGui:Destroy() end

		local screenGui = Instance.new("ScreenGui")
		screenGui.Name = "ESP_Name_GUI"
		screenGui.Parent = localPlayer:WaitForChild("PlayerGui")

		local camera = workspace.CurrentCamera

		local function createESPName(model, displayName)
			local nameLabel = Instance.new("TextLabel")
			nameLabel.Name = "ESP_Name_" .. displayName
			nameLabel.Size = UDim2.new(0, 200, 0, 20)
			nameLabel.BackgroundTransparency = 1
			nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
			nameLabel.TextStrokeTransparency = 0
			nameLabel.TextScaled = true
			nameLabel.Text = displayName
			nameLabel.Parent = screenGui

			local healthBar = Instance.new("Frame")
			healthBar.Name = "ESP_Health_" .. displayName
			healthBar.Size = UDim2.new(0, 100, 0, 10)
			healthBar.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
			healthBar.BorderSizePixel = 1
			healthBar.BorderColor3 = Color3.fromRGB(255, 255, 255)
			healthBar.Parent = screenGui

			local healthFill = Instance.new("Frame")
			healthFill.Name = "Fill"
			healthFill.Size = UDim2.new(1, 0, 1, 0)
			healthFill.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
			healthFill.BorderSizePixel = 0
			healthFill.Parent = healthBar

			RunService.RenderStepped:Connect(function()
				local head, humanoid, rootPart
				if model:IsA("Player") then
					local character = model.Character
					if character then
						head = character:FindFirstChild("Head")
						humanoid = character:FindFirstChild("Humanoid")
						rootPart = character:FindFirstChild("HumanoidRootPart")
					end
				else
					head = model:FindFirstChild("Head")
					humanoid = model:FindFirstChildOfClass("Humanoid")
					rootPart = model:FindFirstChild("HumanoidRootPart")
				end

				if head and humanoid then
					local headPos = head.Position + Vector3.new(0, head.Size.Y/2 + 1, 0)
					local headScreen = camera:WorldToViewportPoint(headPos)

					if headScreen.Z > 0 then
						nameLabel.Position = UDim2.new(0, headScreen.X - 100, 0, headScreen.Y - 30)
						nameLabel.Visible = true
					else
						nameLabel.Visible = false
					end

					if rootPart then
						local rootScreen = camera:WorldToViewportPoint(rootPart.Position + Vector3.new(2, 0, 0))
						if rootScreen.Z > 0 then
							local healthPercent = humanoid.Health / humanoid.MaxHealth
							healthFill.Size = UDim2.new(healthPercent, 0, 1, 0)
							healthBar.Position = UDim2.new(0, rootScreen.X, 0, rootScreen.Y - 5)
							healthBar.Visible = true
						else
							healthBar.Visible = false
						end
					else
						healthBar.Visible = false
					end
				else
					nameLabel.Visible = false
					healthBar.Visible = false
				end
			end)
		end

		for _, player in pairs(Players:GetPlayers()) do
			if player ~= localPlayer then
				createESPName(player, player.Name)
			end
		end

		Players.PlayerAdded:Connect(function(player)
			if player ~= localPlayer then
				createESPName(player, player.Name)
			end
		end)

		-- Apply to entities if ESP Entidade is enabled
		if _G.ESPEntity then
			for _, model in pairs(workspace:GetDescendants()) do
				if model:IsA("Model") and model ~= localPlayer.Character then
					local humanoid = model:FindFirstChildOfClass("Humanoid")
					if humanoid and humanoid.Health > 0 then
						createESPName(model, model.Name)
					end
				end
			end
		end
	else
		-- Disable ESP Name
		local existingGui = game.Players.LocalPlayer:WaitForChild("PlayerGui"):FindFirstChild("ESP_Name_GUI")
		if existingGui then existingGui:Destroy() end
	end
end

-- Function to update Tracer ESP
_G.UpdateTracerESP = function()
	if _G.TracerESP then
		-- Enable Tracer ESP
		local Players = game:GetService("Players")
		local RunService = game:GetService("RunService")
		local Camera = workspace.CurrentCamera
		local LocalPlayer = Players.LocalPlayer

		-- Pasta para guardar as linhas
		local tracersFolder = Instance.new("Folder")
		tracersFolder.Name = "ESP_Tracers"
		tracersFolder.Parent = LocalPlayer:WaitForChild("PlayerGui")

		local tracers = {}

		-- Criar linha
		local function createTracer(model, displayName)
			local line = Drawing.new("Line")
			line.Color = Color3.fromRGB(255, 0, 255)
			line.Thickness = 2
			line.Transparency = 1
			line.Visible = false

			tracers[model] = line
		end

		-- Remover linha
		local function removeTracer(model)
			if tracers[model] then
				tracers[model]:Remove()
				tracers[model] = nil
			end
		end

		-- Criar para players atuais
		for _, player in pairs(Players:GetPlayers()) do
			if player ~= LocalPlayer then
				createTracer(player, player.Name)
			end
		end

		-- Criar para entidades se ESP Entidade ativo
		if _G.ESPEntity then
			for _, model in pairs(workspace:GetDescendants()) do
				if model:IsA("Model") and model ~= LocalPlayer.Character then
					local humanoid = model:FindFirstChildOfClass("Humanoid")
					if humanoid and humanoid.Health > 0 then
						createTracer(model, model.Name)
					end
				end
			end
		end

		local playerAdded = Players.PlayerAdded:Connect(function(player)
			if player ~= LocalPlayer then
				createTracer(player, player.Name)
			end
		end)
		local playerRemoving = Players.PlayerRemoving:Connect(removeTracer)

		-- Verificar novas entidades periodicamente
		local entityCheckConnection = RunService.Heartbeat:Connect(function()
			if _G.ESPEntity then
				for _, model in pairs(workspace:GetDescendants()) do
					if model:IsA("Model") and model ~= LocalPlayer.Character and not tracers[model] then
						local humanoid = model:FindFirstChildOfClass("Humanoid")
						if humanoid and humanoid.Health > 0 then
							createTracer(model, model.Name)
						end
					end
				end
			end
		end)

		-- Atualizar linhas
		local tracerConnection = RunService.RenderStepped:Connect(function()
			local screenSize = Camera.ViewportSize
			local startPoint = Vector2.new(screenSize.X / 2, 0) -- topo da tela

			for model, line in pairs(tracers) do
				local root, humanoid
				if model:IsA("Player") then
					local character = model.Character
					root = character and character:FindFirstChild("HumanoidRootPart")
					humanoid = character and character:FindFirstChildOfClass("Humanoid")
				else
					root = model:FindFirstChild("HumanoidRootPart")
					humanoid = model:FindFirstChildOfClass("Humanoid")
				end

				if root and humanoid and humanoid.Health > 0 then
					local pos, onScreen = Camera:WorldToViewportPoint(root.Position)

					if onScreen then
						line.From = startPoint
						line.To = Vector2.new(pos.X, pos.Y)
						line.Visible = true
					else
						line.Visible = false
					end
				else
					line.Visible = false
				end
			end
		end)

		-- Store data for disable
		_G.TracerESPData = {
			tracersFolder = tracersFolder,
			tracers = tracers,
			tracerConnection = tracerConnection,
			playerAdded = playerAdded,
			playerRemoving = playerRemoving,
			entityCheckConnection = entityCheckConnection
		}
	else
		-- Disable Tracer ESP
		if _G.TracerESPData then
			_G.TracerESPData.tracerConnection:Disconnect()
			_G.TracerESPData.playerAdded:Disconnect()
			_G.TracerESPData.playerRemoving:Disconnect()
			for _, line in pairs(_G.TracerESPData.tracers) do
				line:Remove()
			end
			_G.TracerESPData.tracersFolder:Destroy()
			_G.TracerESPData = nil
		end
	end
end

-- Function to update ESP Entidade
_G.UpdateESPEntity = function()
	-- Refresh ESP functions to apply to entities if enabled
	_G.UpdateMasterESP()
	_G.UpdateESPName()
	_G.UpdateTracerESP()
end

-- Toggle Master ESP
createToggleRow(espTab, 50, "Master ESP", "MasterESP", "UpdateMasterESP")

-- Toggle ESP Name
createToggleRow(espTab, 90, "Name ESP", "ESPName", "UpdateESPName")

-- Toggle Tracer ESP
createToggleRow(espTab, 130, "Tracer ESP", "TracerESP", "UpdateTracerESP")

-- Toggle ESP Entidade
createToggleRow(espTab, 170, "ESP Entidade", "ESPEntity", "UpdateESPEntity")

-- Aba AIM
local aimTab = Instance.new("ScrollingFrame")
aimTab.Name = "AIMTab"
aimTab.Size = UDim2.new(1, 0, 1, 0)
aimTab.BackgroundTransparency = 1
aimTab.Visible = false
aimTab.CanvasSize = UDim2.new(0, 0, 0, 500)
aimTab.ScrollBarThickness = 6
aimTab.Parent = content

-- Aba New AIM
local newAIMTab = Instance.new("Frame")
newAIMTab.Name = "NewAIMTab"
newAIMTab.Size = UDim2.new(1, 0, 1, 0)
newAIMTab.BackgroundTransparency = 1
newAIMTab.Visible = false
newAIMTab.Parent = content

local newAIMTitle = Instance.new("TextLabel")
newAIMTitle.Name = "NewAIMTitle"
newAIMTitle.Text = "AIM Configurações"
newAIMTitle.Size = UDim2.new(1, -20, 0, 30)
newAIMTitle.Position = UDim2.new(0, 10, 0, 10)
newAIMTitle.BackgroundTransparency = 1
newAIMTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
newAIMTitle.Font = Enum.Font.SourceSans
newAIMTitle.TextSize = 20
newAIMTitle.Parent = newAIMTab

-- Aba Player
local playerTab = Instance.new("Frame")
playerTab.Name = "PlayerTab"
playerTab.Size = UDim2.new(1, 0, 1, 0)
playerTab.BackgroundTransparency = 1
playerTab.Visible = false
playerTab.Parent = content

local playerTitle = Instance.new("TextLabel")
playerTitle.Name = "PlayerTitle"
playerTitle.Text = "Configurações do Player"
playerTitle.Size = UDim2.new(1, -20, 0, 30)
playerTitle.Position = UDim2.new(0, 10, 0, 10)
playerTitle.BackgroundTransparency = 1
playerTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
playerTitle.Font = Enum.Font.SourceSans
playerTitle.TextSize = 20
playerTitle.Parent = playerTab

-- Function to update Infinite Jump
_G.UpdateInfiniteJump = function()
	if _G.InfiniteJump then
		-- Enable Infinite Jump
		if not _G.InfiniteJumpConnection then
			_G.InfiniteJumpConnection = UserInputService.JumpRequest:Connect(function()
				local character = localPlayer.Character
				if not character then return end
				local humanoid = character:FindFirstChildOfClass("Humanoid")
				if humanoid then
					humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
				end
			end)
		end
	else
		-- Disable Infinite Jump
		if _G.InfiniteJumpConnection then
			_G.InfiniteJumpConnection:Disconnect()
			_G.InfiniteJumpConnection = nil
		end
	end
end

-- Function to update Speed Boost
_G.UpdateSpeedBoost = function()
	if _G.SpeedBoost then
		-- Enable Speed Boost
		local humanoid = localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid")
		if humanoid then
			humanoid.WalkSpeed = 100 -- Set high speed
		end
	else
		-- Disable Speed Boost
		local humanoid = localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid")
		if humanoid then
			humanoid.WalkSpeed = 16 -- Reset to default
		end
	end
end

-- Function to update Fly
_G.UpdateFly = function()
	if _G.Fly then
		-- Enable Fly
		local character = localPlayer.Character
		if character then
			local humanoid = character:FindFirstChildOfClass("Humanoid")
			local rootPart = character:FindFirstChild("HumanoidRootPart")
			local camera = workspace.CurrentCamera
			if humanoid and rootPart and camera then
				humanoid.PlatformStand = true
				local bv = Instance.new("BodyVelocity")
				bv.Velocity = Vector3.zero
				bv.MaxForce = Vector3.new(10000, 10000, 10000)
				bv.Name = "FlyBV"
				bv.Parent = rootPart
				local bg = Instance.new("BodyGyro")
				bg.MaxTorque = Vector3.new(4000, 4000, 4000)
				bg.Name = "FlyBG"
				bg.Parent = rootPart
				_G.FlyConnection = RunService.RenderStepped:Connect(function()
					local moveDirection = Vector3.zero
					if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDirection = moveDirection + camera.CFrame.LookVector end
					if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDirection = moveDirection - camera.CFrame.LookVector end
					if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDirection = moveDirection - camera.CFrame.RightVector end
					if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDirection = moveDirection + camera.CFrame.RightVector end
					if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveDirection = moveDirection + Vector3.new(0, 1, 0) end
					if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then moveDirection = moveDirection - Vector3.new(0, 1, 0) end
					bv.Velocity = moveDirection * 50
					bg.CFrame = camera.CFrame
				end)
			end
		end
	else
		-- Disable Fly
		local character = localPlayer.Character
		if character then
			local humanoid = character:FindFirstChildOfClass("Humanoid")
			local rootPart = character:FindFirstChild("HumanoidRootPart")
			if humanoid then humanoid.PlatformStand = false end
			if rootPart then
				local bv = rootPart:FindFirstChild("FlyBV")
				if bv then bv:Destroy() end
				local bg = rootPart:FindFirstChild("FlyBG")
				if bg then bg:Destroy() end
			end
			if _G.FlyConnection then
				_G.FlyConnection:Disconnect()
				_G.FlyConnection = nil
			end
		end
	end
end

-- Toggle Infinite Jump
createToggleRow(playerTab, 50, "Pulo Infinito", "InfiniteJump", "UpdateInfiniteJump")

-- Toggle Speed Boost
createToggleRow(playerTab, 90, "Boost de Velocidade", "SpeedBoost", "UpdateSpeedBoost")

-- Toggle Fly
createToggleRow(playerTab, 130, "Fly", "Fly", "UpdateFly")

-- Botão Fly Hub
local flyHubButton = Instance.new("TextButton")
flyHubButton.Name = "FlyHubButton"
flyHubButton.Text = "Fly hub"
flyHubButton.Size = UDim2.new(1, -20, 0, 30)
flyHubButton.Position = UDim2.new(0, 10, 0, 170)
flyHubButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
flyHubButton.BackgroundTransparency = 0
flyHubButton.BorderSizePixel = 1
flyHubButton.BorderColor3 = Color3.fromRGB(128, 0, 128)
flyHubButton.TextColor3 = Color3.fromRGB(255, 255, 255)
flyHubButton.Font = Enum.Font.SourceSans
flyHubButton.TextSize = 18
flyHubButton.Parent = playerTab

local flyHubCorner = Instance.new("UICorner")
flyHubCorner.CornerRadius = UDim.new(0, 8)
flyHubCorner.Parent = flyHubButton

flyHubButton.MouseButton1Click:Connect(function()
	-- Criar Fly GUI
	local main = Instance.new("ScreenGui")
	main.Name = "FlyHubGui"
	main.Parent = playerGui
	main.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	main.ResetOnSpawn = false

	local Frame = Instance.new("Frame")
	Frame.Parent = main
	Frame.BackgroundColor3 = Color3.fromRGB(50, 0, 50) -- Purple-black mix
	Frame.BorderColor3 = Color3.fromRGB(128, 0, 128)
	Frame.Position = UDim2.new(0.100320168, 0, 0.379746825, 0)
	Frame.Size = UDim2.new(0, 190, 0, 57)
	Frame.Active = true
	Frame.Draggable = true

	local uiCorner = Instance.new("UICorner")
	uiCorner.CornerRadius = UDim.new(0, 10)
	uiCorner.Parent = Frame

	local up = Instance.new("TextButton")
	up.Name = "up"
	up.Parent = Frame
	up.BackgroundColor3 = Color3.fromRGB(100, 0, 100) -- Dark purple
	up.Size = UDim2.new(0, 44, 0, 28)
	up.Font = Enum.Font.SourceSans
	up.Text = "UP"
	up.TextColor3 = Color3.fromRGB(255, 255, 255)
	up.TextSize = 14.000

	local down = Instance.new("TextButton")
	down.Name = "down"
	down.Parent = Frame
	down.BackgroundColor3 = Color3.fromRGB(100, 0, 100) -- Dark purple
	down.Position = UDim2.new(0, 0, 0.491228074, 0)
	down.Size = UDim2.new(0, 44, 0, 28)
	down.Font = Enum.Font.SourceSans
	down.Text = "DOWN"
	down.TextColor3 = Color3.fromRGB(255, 255, 255)
	down.TextSize = 14.000

	local onof = Instance.new("TextButton")
	onof.Name = "onof"
	onof.Parent = Frame
	onof.BackgroundColor3 = Color3.fromRGB(150, 0, 150) -- Lighter purple
	onof.Position = UDim2.new(0.702823281, 0, 0.491228074, 0)
	onof.Size = UDim2.new(0, 56, 0, 28)
	onof.Font = Enum.Font.SourceSans
	onof.Text = "fly"
	onof.TextColor3 = Color3.fromRGB(0, 0, 0)
	onof.TextSize = 14.000

	local TextLabel = Instance.new("TextLabel")
	TextLabel.Parent = Frame
	TextLabel.BackgroundColor3 = Color3.fromRGB(128, 0, 128) -- Purple
	TextLabel.Position = UDim2.new(0.469327301, 0, 0, 0)
	TextLabel.Size = UDim2.new(0, 100, 0, 28)
	TextLabel.Font = Enum.Font.SourceSans
	TextLabel.Text = "FLY UwU"
	TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	TextLabel.TextScaled = true
	TextLabel.TextSize = 14.000
	TextLabel.TextWrapped = true

	local plus = Instance.new("TextButton")
	plus.Name = "plus"
	plus.Parent = Frame
	plus.BackgroundColor3 = Color3.fromRGB(100, 0, 100) -- Dark purple
	plus.Position = UDim2.new(0.231578946, 0, 0, 0)
	plus.Size = UDim2.new(0, 45, 0, 28)
	plus.Font = Enum.Font.SourceSans
	plus.Text = "+"
	plus.TextColor3 = Color3.fromRGB(255, 255, 255)
	plus.TextScaled = true
	plus.TextSize = 14.000
	plus.TextWrapped = true

	local speed = Instance.new("TextLabel")
	speed.Name = "speed"
	speed.Parent = Frame
	speed.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Black
	speed.Position = UDim2.new(0.468421042, 0, 0.491228074, 0)
	speed.Size = UDim2.new(0, 44, 0, 28)
	speed.Font = Enum.Font.SourceSans
	speed.Text = "1"
	speed.TextColor3 = Color3.fromRGB(255, 255, 255)
	speed.TextScaled = true
	speed.TextSize = 14.000
	speed.TextWrapped = true

	local mine = Instance.new("TextButton")
	mine.Name = "mine"
	mine.Parent = Frame
	mine.BackgroundColor3 = Color3.fromRGB(100, 0, 100) -- Dark purple
	mine.Position = UDim2.new(0.231578946, 0, 0.491228074, 0)
	mine.Size = UDim2.new(0, 45, 0, 29)
	mine.Font = Enum.Font.SourceSans
	mine.Text = "-"
	mine.TextColor3 = Color3.fromRGB(255, 255, 255)
	mine.TextScaled = true
	mine.TextSize = 14.000
	mine.TextWrapped = true

	local closebutton = Instance.new("TextButton")
	closebutton.Name = "Close"
	closebutton.Parent = Frame
	closebutton.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Black
	closebutton.Font = "SourceSans"
	closebutton.Size = UDim2.new(0, 45, 0, 28)
	closebutton.Text = "X"
	closebutton.TextSize = 30
	closebutton.Position = UDim2.new(0, 0, -1, 27)
	closebutton.TextColor3 = Color3.fromRGB(255, 255, 255)

	local mini = Instance.new("TextButton")
	mini.Name = "minimize"
	mini.Parent = Frame
	mini.BackgroundColor3 = Color3.fromRGB(100, 0, 100) -- Dark purple
	mini.Font = "SourceSans"
	mini.Size = UDim2.new(0, 45, 0, 28)
	mini.Text = "-"
	mini.TextSize = 40
	mini.Position = UDim2.new(0, 44, -1, 27)
	mini.TextColor3 = Color3.fromRGB(255, 255, 255)

	local mini2 = Instance.new("TextButton")
	mini2.Name = "minimize2"
	mini2.Parent = Frame
	mini2.BackgroundColor3 = Color3.fromRGB(100, 0, 100) -- Dark purple
	mini2.Font = "SourceSans"
	mini2.Size = UDim2.new(0, 45, 0, 28)
	mini2.Text = "+"
	mini2.TextSize = 40
	mini2.Position = UDim2.new(0, 44, -1, 57)
	mini2.Visible = false
	mini2.TextColor3 = Color3.fromRGB(255, 255, 255)

	local speeds = 1

	local speaker = game:GetService("Players").LocalPlayer

	local chr = game.Players.LocalPlayer.Character
	local hum = chr and chr:FindFirstChildWhichIsA("Humanoid")

	nowe = false

	game:GetService("StarterGui"):SetCore("SendNotification", { 
		Title = "FLY HUB";
		Text = "BY FbiUwU";
		Icon = "rbxthumb://type=Asset&id=5107182114&w=150&h=150"})
	Duration = 5;

	onof.MouseButton1Down:connect(function()

		if nowe == true then
			nowe = false

			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Climbing,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Flying,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Freefall,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.GettingUp,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Landed,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Physics,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.PlatformStanding,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Running,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.RunningNoPhysics,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.StrafingNoPhysics,true)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Swimming,true)
			speaker.Character.Humanoid:ChangeState(Enum.HumanoidStateType.RunningNoPhysics)
		else 
			nowe = true



			for i = 1, speeds do
				spawn(function()

					local hb = game:GetService("RunService").Heartbeat	


					tpwalking = true
					local chr = game.Players.LocalPlayer.Character
					local hum = chr and chr:FindFirstChildWhichIsA("Humanoid")
					while tpwalking and hb:Wait() and chr and hum and hum.Parent do
						if hum.MoveDirection.Magnitude > 0 then
							chr:TranslateBy(hum.MoveDirection)
						end
					end

				end)
			end
			game.Players.LocalPlayer.Character.Animate.Disabled = true
			local Char = game.Players.LocalPlayer.Character
			local Hum = Char:FindFirstChildOfClass("Humanoid") or Char:FindFirstChildOfClass("AnimationController")

			for i,v in next, Hum:GetPlayingAnimationTracks() do
				v:AdjustSpeed(0)
			end
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Climbing,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Flying,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Freefall,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.GettingUp,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Landed,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Physics,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.PlatformStanding,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Running,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.RunningNoPhysics,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.StrafingNoPhysics,false)
			speaker.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Swimming,false)
			speaker.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Swimming)
		end




		if game:GetService("Players").LocalPlayer.Character:FindFirstChildOfClass("Humanoid").RigType == Enum.HumanoidRigType.R6 then



			local plr = game.Players.LocalPlayer
			local torso = plr.Character.Torso
			local flying = true
			local deb = true
			local ctrl = {f = 0, b = 0, l = 0, r = 0}
			local lastctrl = {f = 0, b = 0, l = 0, r = 0}
			local maxspeed = 50
			local speed = 0


			local bg = Instance.new("BodyGyro", torso)
			bg.P = 9e4
			bg.maxTorque = Vector3.new(9e9, 9e9, 9e9)
			bg.cframe = torso.CFrame
			local bv = Instance.new("BodyVelocity", torso)
			bv.velocity = Vector3.new(0,0.1,0)
			bv.maxForce = Vector3.new(9e9, 9e9, 9e9)
			if nowe == true then
				plr.Character.Humanoid.PlatformStand = true
			end
			while nowe == true or game:GetService("Players").LocalPlayer.Character.Humanoid.Health == 0 do
				game:GetService("RunService").RenderStepped:Wait()

				if ctrl.l + ctrl.r ~= 0 or ctrl.f + ctrl.b ~= 0 then
					speed = speed+.5+(speed/maxspeed)
					if speed > maxspeed then
						speed = maxspeed
					end
				elseif not (ctrl.l + ctrl.r ~= 0 or ctrl.f + ctrl.b ~= 0) and speed ~= 0 then
					speed = speed-1
					if speed < 0 then
						speed = 0
					end
				end
				if (ctrl.l + ctrl.r) ~= 0 or (ctrl.f + ctrl.b) ~= 0 then
					bv.velocity = ((game.Workspace.CurrentCamera.CoordinateFrame.lookVector * (ctrl.f+ctrl.b)) + ((game.Workspace.CurrentCamera.CoordinateFrame * CFrame.new(ctrl.l+ctrl.r,(ctrl.f+ctrl.b)*.2,0).p) - game.Workspace.CurrentCamera.CoordinateFrame.p))*speed
					lastctrl = {f = ctrl.f, b = ctrl.b, l = ctrl.l, r = ctrl.r}
				elseif (ctrl.l + ctrl.r) == 0 and (ctrl.f + ctrl.b) == 0 and speed ~= 0 then
					bv.velocity = ((game.Workspace.CurrentCamera.CoordinateFrame.lookVector * (lastctrl.f+lastctrl.b)) + ((game.Workspace.CurrentCamera.CoordinateFrame * CFrame.new(lastctrl.l+lastctrl.r,(lastctrl.f+lastctrl.b)*.2,0).p) - game.Workspace.CurrentCamera.CoordinateFrame.p))*speed
				else
					bv.velocity = Vector3.new(0,0,0)
				end
				--	game.Players.LocalPlayer.Character.Animate.Disabled = true
				bg.cframe = game.Workspace.CurrentCamera.CoordinateFrame * CFrame.Angles(-math.rad((ctrl.f+ctrl.b)*50*speed/maxspeed),0,0)
			end
			ctrl = {f = 0, b = 0, l = 0, r = 0}
			lastctrl = {f = 0, b = 0, l = 0, r = 0}
			speed = 0
			bg:Destroy()
			bv:Destroy()
			plr.Character.Humanoid.PlatformStand = false
			game.Players.LocalPlayer.Character.Animate.Disabled = false
			tpwalking = false




		else
			local plr = game.Players.LocalPlayer
			local UpperTorso = plr.Character.UpperTorso
			local flying = true
			local deb = true
			local ctrl = {f = 0, b = 0, l = 0, r = 0}
			local lastctrl = {f = 0, b = 0, l = 0, r = 0}
			local maxspeed = 50
			local speed = 0


			local bg = Instance.new("BodyGyro", UpperTorso)
			bg.P = 9e4
			bg.maxTorque = Vector3.new(9e9, 9e9, 9e9)
			bg.cframe = UpperTorso.CFrame
			local bv = Instance.new("BodyVelocity", UpperTorso)
			bv.velocity = Vector3.new(0,0.1,0)
			bv.maxForce = Vector3.new(9e9, 9e9, 9e9)
			if nowe == true then
				plr.Character.Humanoid.PlatformStand = true
			end
			while nowe == true or game:GetService("Players").LocalPlayer.Character.Humanoid.Health == 0 do
				wait()

				if ctrl.l + ctrl.r ~= 0 or ctrl.f + ctrl.b ~= 0 then
					speed = speed+.5+(speed/maxspeed)
					if speed > maxspeed then
						speed = maxspeed
					end
				elseif not (ctrl.l + ctrl.r ~= 0 or ctrl.f + ctrl.b ~= 0) and speed ~= 0 then
					speed = speed-1
					if speed < 0 then
						speed = 0
					end
				end
				if (ctrl.l + ctrl.r) ~= 0 or (ctrl.f + ctrl.b) ~= 0 then
					bv.velocity = ((game.Workspace.CurrentCamera.CoordinateFrame.lookVector * (ctrl.f+ctrl.b)) + ((game.Workspace.CurrentCamera.CoordinateFrame * CFrame.new(ctrl.l+ctrl.r,(ctrl.f+ctrl.b)*.2,0).p) - game.Workspace.CurrentCamera.CoordinateFrame.p))*speed
					lastctrl = {f = ctrl.f, b = ctrl.b, l = ctrl.l, r = ctrl.r}
				elseif (ctrl.l + ctrl.r) == 0 and (ctrl.f + ctrl.b) == 0 and speed ~= 0 then
					bv.velocity = ((game.Workspace.CurrentCamera.CoordinateFrame.lookVector * (lastctrl.f+lastctrl.b)) + ((game.Workspace.CurrentCamera.CoordinateFrame * CFrame.new(lastctrl.l+lastctrl.r,(lastctrl.f+lastctrl.b)*.2,0).p) - game.Workspace.CurrentCamera.CoordinateFrame.p))*speed
				else
					bv.velocity = Vector3.new(0,0,0)
				end

				bg.cframe = game.Workspace.CurrentCamera.CoordinateFrame * CFrame.Angles(-math.rad((ctrl.f+ctrl.b)*50*speed/maxspeed),0,0)
			end
			ctrl = {f = 0, b = 0, l = 0, r = 0}
			lastctrl = {f = 0, b = 0, l = 0, r = 0}
			speed = 0
			bg:Destroy()
			bv:Destroy()
			plr.Character.Humanoid.PlatformStand = false
			game.Players.LocalPlayer.Character.Animate.Disabled = false
			tpwalking = false



		end





	end)

	local tis

	up.MouseButton1Down:connect(function()
		tis = up.MouseEnter:connect(function()
			while tis do
				wait()
				game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0,1,0)
			end
		end)
	end)

	up.MouseLeave:connect(function()
		if tis then
			tis:Disconnect()
			tis = nil
		end
	end)

	local dis

	down.MouseButton1Down:connect(function()
		dis = down.MouseEnter:connect(function()
			while dis do
				wait()
				game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0,-1,0)
			end
		end)
	end)

	down.MouseLeave:connect(function()
		if dis then
			dis:Disconnect()
			dis = nil
		end
	end)


	game:GetService("Players").LocalPlayer.CharacterAdded:Connect(function(char)
		wait(0.7)
		game.Players.LocalPlayer.Character.Humanoid.PlatformStand = false
		game.Players.LocalPlayer.Character.Animate.Disabled = false

	end)


	plus.MouseButton1Down:connect(function()
		speeds = speeds + 1
		speed.Text = speeds
		if nowe == true then


			tpwalking = false
			for i = 1, speeds do
				spawn(function()

					local hb = game:GetService("RunService").Heartbeat	


					tpwalking = true
					local chr = game.Players.LocalPlayer.Character
					local hum = chr and chr:FindFirstChildWhichIsA("Humanoid")
					while tpwalking and hb:Wait() and chr and hum and hum.Parent do
						if hum.MoveDirection.Magnitude > 0 then
							chr:TranslateBy(hum.MoveDirection)
						end
					end

				end)
			end
		end
	end)
	mine.MouseButton1Down:connect(function()
		if speeds == 1 then
			speed.Text = 'cannot be less than 1'
			wait(1)
			speed.Text = speeds
		else
			speeds = speeds - 1
			speed.Text = speeds
			if nowe == true then
				tpwalking = false
				for i = 1, speeds do
					spawn(function()

						local hb = game:GetService("RunService").Heartbeat	


						tpwalking = true
						local chr = game.Players.LocalPlayer.Character
						local hum = chr and chr:FindFirstChildWhichIsA("Humanoid")
						while tpwalking and hb:Wait() and chr and hum and hum.Parent do
							if hum.MoveDirection.Magnitude > 0 then
								chr:TranslateBy(hum.MoveDirection)
							end
						end

					end)
				end
			end
		end
	end)

	closebutton.MouseButton1Click:Connect(function()
		main:Destroy()
	end)

	mini.MouseButton1Click:Connect(function()
		up.Visible = false
		down.Visible = false
		onof.Visible = false
		plus.Visible = false
		speed.Visible = false
		mine.Visible = false
		mini.Visible = false
		mini2.Visible = true
		Frame.BackgroundTransparency = 1
		closebutton.Position = UDim2.new(0, 0, -1, 57)
	end)

	mini2.MouseButton1Click:Connect(function()
		up.Visible = true
		down.Visible = true
		onof.Visible = true
		plus.Visible = true
		speed.Visible = true
		mine.Visible = true
		mini.Visible = true
		mini2.Visible = false
		Frame.BackgroundTransparency = 0 
		closebutton.Position = UDim2.new(0, 0, -1, 27)
	end)
end)

local aimTitle = Instance.new("TextLabel")
aimTitle.Name = "AIMTitle"
aimTitle.Text = "Fuder Geral KKKKKKJ"
aimTitle.Size = UDim2.new(1, -20, 0, 30)
aimTitle.Position = UDim2.new(0, 10, 0, 10)
aimTitle.BackgroundTransparency = 1
aimTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
aimTitle.Font = Enum.Font.SourceSans
aimTitle.TextSize = 20
aimTitle.Parent = aimTab

-- ===== VARIÁVEIS =====
local selectedPlayer = nil
local selectedButton = nil
local listOpen = false

-- transformar em botão
local searchButton = Instance.new("TextButton")
searchButton.Size = UDim2.new(1, -20, 0, 30)
searchButton.Position = UDim2.new(0, 10, 0, 50)
searchButton.Text = "procurar player ▼"
searchButton.BackgroundTransparency = 1
searchButton.TextColor3 = Color3.new(1,1,1)
searchButton.Font = Enum.Font.SourceSans
searchButton.TextSize = 18
searchButton.Parent = aimTab

-- Janela da lista de players
local playerListFrame = Instance.new("Frame")
playerListFrame.Size = UDim2.new(1, -20, 0, 200)
playerListFrame.Position = UDim2.new(0, 10, 0, 100)
playerListFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
playerListFrame.BorderSizePixel = 0
playerListFrame.Visible = false
playerListFrame.Parent = aimTab

local corner = Instance.new("UICorner", playerListFrame)
corner.CornerRadius = UDim.new(0, 12)

-- Título da lista
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundTransparency = 1
title.Text = "Players da Partida"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 18
title.Parent = playerListFrame

-- Área da lista
local listFrame = Instance.new("ScrollingFrame")
listFrame.Size = UDim2.new(1, -10, 1, -40)
listFrame.Position = UDim2.new(0, 5, 0, 35)
listFrame.CanvasSize = UDim2.new(0,0,0,0)
listFrame.ScrollBarImageTransparency = 0.3
listFrame.BackgroundTransparency = 1
listFrame.Parent = playerListFrame

local layout = Instance.new("UIListLayout", listFrame)
layout.Padding = UDim.new(0, 6)

layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	listFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 5)
end)

searchButton.MouseButton1Click:Connect(function()
	listOpen = not listOpen
	playerListFrame.Visible = listOpen
	searchButton.Text = listOpen and "fechar lista ▲" or "procurar player ▼"
end)

-- Botão Teletransportar
local teleportButton = Instance.new("TextButton")
teleportButton.Name = "TeleportButton"
teleportButton.Text = "teletransportar"
teleportButton.Size = UDim2.new(1, -20, 0, 30)
teleportButton.Position = UDim2.new(0, 10, 0, 310)
teleportButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
teleportButton.BackgroundTransparency = 0
teleportButton.BorderSizePixel = 1
teleportButton.BorderColor3 = Color3.fromRGB(128, 0, 128)
teleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
teleportButton.Font = Enum.Font.SourceSans
teleportButton.TextSize = 18
teleportButton.Parent = aimTab

local teleportCorner = Instance.new("UICorner", teleportButton)
teleportCorner.CornerRadius = UDim.new(0, 8)

teleportButton.MouseButton1Click:Connect(function()
	if selectedPlayer then
		teleportToPlayer(selectedPlayer)
	end
end)

-- Texto abaixo do teletransportar
local tpText = Instance.new("TextLabel")
tpText.Name = "TPText"
tpText.Text = "Clique aqui pra dar TP no player selecionado"
tpText.Size = UDim2.new(1, -20, 0, 20)
tpText.Position = UDim2.new(0, 10, 0, 345)
tpText.BackgroundTransparency = 1
tpText.TextColor3 = Color3.fromRGB(128, 0, 128)
tpText.Font = Enum.Font.SourceSans
tpText.TextSize = 14
tpText.TextXAlignment = Enum.TextXAlignment.Center
tpText.Parent = aimTab

-- Toggle AIM Bot
createToggleRow(aimTab, 370, "HS Pescoço do uriel", "AIMBot", "UpdateAIMBot")

-- Toggle FFH4X
createToggleRow(newAIMTab, 50, "FFH4X", "FFH4X", "UpdateFFH4X")

-- Toggle AIM Disfarçado
createToggleRow(newAIMTab, 90, "AIM Disfarçado", "AIMDisfarcado", "UpdateAIMDisfarcado")



-- Function to update AIM Bot
_G.UpdateAIMBot = function()
	if _G.AIMBot then
		-- Enable AIM Bot
		print("AIM Bot enabled")

		local function getClosestPlayer()
			local closest
			local minDist = math.huge

			local myChar = localPlayer.Character
			if not myChar or not myChar:FindFirstChild("HumanoidRootPart") then
				return nil
			end

			local myPos = myChar.HumanoidRootPart.Position

			for _, player in pairs(Players:GetPlayers()) do
				if player ~= localPlayer
					and player.Character
					and player.Character:FindFirstChild("Head")
					and player.Character:FindFirstChild("Humanoid")
					and player.Character.Humanoid.Health > 0 then

					local head = player.Character.Head
					local dist = (head.Position - myPos).Magnitude

					if dist < minDist then
						minDist = dist
						closest = player
					end
				end
			end

			return closest
		end

		-- Start teleport loop
		if not _G.AimConnection then
			_G.AimConnection = RunService.RenderStepped:Connect(function()
				local myChar = localPlayer.Character
				if not myChar then return end

				local myRoot = myChar:FindFirstChild("HumanoidRootPart")
				if not myRoot then return end

				local target = getClosestPlayer()
				if not target or not target.Character then return end

				local targetHead = target.Character:FindFirstChild("Head")
				if not targetHead then return end

				-- posição ligeiramente atrás da cabeça do alvo
				local offset = Vector3.new(0, 0, -2)

				-- teleporta seu player olhando para o alvo
				myRoot.CFrame = CFrame.new(
					targetHead.Position + offset,
					targetHead.Position
				)

				-- força a câmera a olhar para a cabeça
				local camera = workspace.CurrentCamera
				camera.CFrame = CFrame.new(
					camera.CFrame.Position,
					targetHead.Position
				)
			end)
		end
	else
		-- Disable AIM Bot
		print("AIM Bot disabled")

		-- Stop teleporting
		if _G.AimConnection then
			_G.AimConnection:Disconnect()
			_G.AimConnection = nil
		end
	end
end

-- Function to update FFH4X
_G.UpdateFFH4X = function()
	if _G.FFH4X then
		-- Enable FFH4X Aimbot
		print("FFH4X Aimbot enabled")

		local Players = game:GetService("Players")
		local RunService = game:GetService("RunService")
		local Workspace = game:GetService("Workspace")

		local LocalPlayer = Players.LocalPlayer
		local Camera = Workspace.CurrentCamera

		local AIM_PART = "Head"
		local MAX_DISTANCE = 2000

		-- Raycast params
		local rayParams = RaycastParams.new()
		rayParams.FilterType = Enum.RaycastFilterType.Blacklist
		rayParams.IgnoreWater = true

		-- verifica se o alvo está visível (sem parede)
		local function isVisible(targetPart)
			local origin = Camera.CFrame.Position
			local direction = (targetPart.Position - origin)

			rayParams.FilterDescendantsInstances = {
				LocalPlayer.Character,
				targetPart.Parent
			}

			local rayResult = Workspace:Raycast(origin, direction, rayParams)

			if rayResult then
				-- se bateu em algo que NÃO é o player, tem parede
				if not rayResult.Instance:IsDescendantOf(targetPart.Parent) then
					return false
				end
			end

			return true
		end

		-- pega o player ou entidade mais próximo VISÍVEL
		local function getClosestVisiblePlayer()
			local closestTarget = nil
			local shortestDistance = math.huge

			local myChar = LocalPlayer.Character
			if not myChar then return nil end

			local myRoot = myChar:FindFirstChild("HumanoidRootPart")
			if not myRoot then return nil end

			-- Função auxiliar para verificar e adicionar alvo
			local function checkTarget(character, root, head)
				if root and head then
					local distance = (root.Position - myRoot.Position).Magnitude
					if distance < shortestDistance and distance <= MAX_DISTANCE then
						if isVisible(head) then
							shortestDistance = distance
							closestTarget = head
						end
					end
				end
			end

			-- Verificar players
			for _, player in pairs(Players:GetPlayers()) do
				if player ~= LocalPlayer and player.Character then
					local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
					local root = player.Character:FindFirstChild("HumanoidRootPart")
					local head = player.Character:FindFirstChild(AIM_PART)

					if humanoid and humanoid.Health > 0 then
						checkTarget(player.Character, root, head)
					end
				end
			end

			-- Verificar entidades (NPCs, dummies, etc.) no workspace
			for _, descendant in pairs(Workspace:GetDescendants()) do
				if descendant:IsA("Model") and descendant ~= myChar then
					local humanoid = descendant:FindFirstChildOfClass("Humanoid")
					local root = descendant:FindFirstChild("HumanoidRootPart")
					local head = descendant:FindFirstChild(AIM_PART)

					if humanoid and humanoid.Health > 0 then
						checkTarget(descendant, root, head)
					end
				end
			end

			return closestTarget
		end

		-- LOOP PRINCIPAL
		if not _G.FFH4XConnection then
			_G.FFH4XConnection = RunService.RenderStepped:Connect(function()
				local targetHead = getClosestVisiblePlayer()
				if targetHead then
					local camPos = Camera.CFrame.Position
					Camera.CFrame = CFrame.new(camPos, targetHead.Position)
				end
			end)
		end
	else
		-- Disable FFH4X Aimbot
		print("FFH4X Aimbot disabled")

		-- Stop camera locking
		if _G.FFH4XConnection then
			_G.FFH4XConnection:Disconnect()
			_G.FFH4XConnection = nil
		end
	end
end

-- Function to update AIM Disfarçado
_G.UpdateAIMDisfarcado = function()
	if _G.AIMDisfarcado then
		-- Enable AIM Disfarçado
		print("AIM Disfarçado enabled")

		local Players = game:GetService("Players")
		local RunService = game:GetService("RunService")
		local Workspace = game:GetService("Workspace")

		local LocalPlayer = Players.LocalPlayer
		local Camera = Workspace.CurrentCamera
		local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

		-- CONFIG
		local FOV_RADIUS = 120
		local SMOOTHNESS = 0.12
		local MAX_DISTANCE = 2000
		local AIM_PART = "Head"

		-- Enable FOV Circle
		if not _G.AimFOVGui then
			_G.AimFOVGui = Instance.new("ScreenGui")
			_G.AimFOVGui.Name = "AimFOV"
			_G.AimFOVGui.ResetOnSpawn = false
			_G.AimFOVGui.Parent = PlayerGui

			local circle = Instance.new("Frame")
			circle.Size = UDim2.new(0, FOV_RADIUS * 2, 0, FOV_RADIUS * 2)
			circle.AnchorPoint = Vector2.new(0.5, 0.5)
			circle.Position = UDim2.new(0.5, 0, 0.5, 0)
			circle.BackgroundTransparency = 1
			circle.Parent = _G.AimFOVGui

			local stroke = Instance.new("UIStroke", circle)
			stroke.Thickness = 2
			stroke.Color = Color3.fromRGB(170, 0, 255)

			local corner = Instance.new("UICorner", circle)
			corner.CornerRadius = UDim.new(1, 0)
		end

		-- =========================
		-- RAYCAST (ANTI WALL)
		-- =========================
		local rayParams = RaycastParams.new()
		rayParams.FilterType = Enum.RaycastFilterType.Blacklist
		rayParams.IgnoreWater = true

		local function isVisible(part)
			if not part then return false end

			local origin = Camera.CFrame.Position
			local direction = part.Position - origin

			rayParams.FilterDescendantsInstances = {
				LocalPlayer.Character
			}

			local result = Workspace:Raycast(origin, direction, rayParams)

			-- se bateu em algo que NÃO é o alvo → parede
			if result then
				if not result.Instance:IsDescendantOf(part.Parent) then
					return false
				end
			end

			return true
		end

		-- =========================
		-- DENTRO DO CÍRCULO
		-- =========================
		local function insideFOV(worldPos)
			local screenPos, onScreen = Camera:WorldToViewportPoint(worldPos)
			if not onScreen then return false end

			local center = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
			local point = Vector2.new(screenPos.X, screenPos.Y)

			return (point - center).Magnitude <= FOV_RADIUS
		end

		-- =========================
		-- BUSCA ALVO (PLAYER + NPC)
		-- =========================
		local function getClosestTarget()
			local closest = nil
			local shortest = math.huge

			local myChar = LocalPlayer.Character
			if not myChar then return nil end

			local myRoot = myChar:FindFirstChild("HumanoidRootPart")
			if not myRoot then return nil end

			for _, model in ipairs(Workspace:GetDescendants()) do
				if model:IsA("Model") then
					local hum = model:FindFirstChildOfClass("Humanoid")
					local root = model:FindFirstChild("HumanoidRootPart")
					local head = model:FindFirstChild(AIM_PART)

					if hum and hum.Health > 0 and root and head then
						-- ignora você mesmo
						if Players:GetPlayerFromCharacter(model) == LocalPlayer then
							continue
						end

						local dist = (root.Position - myRoot.Position).Magnitude
						if dist <= MAX_DISTANCE then
							if insideFOV(head.Position) and isVisible(head) then
								if dist < shortest then
									shortest = dist
									closest = head
								end
							end
						end
					end
				end
			end

			return closest
		end

		-- =========================
		-- LOOP AIM SUAVE
		-- =========================
		if not _G.AIMDisfarcadoConnection then
			_G.AIMDisfarcadoConnection = RunService.RenderStepped:Connect(function()
				local target = getClosestTarget()
				if not target then return end

				local camCF = Camera.CFrame
				local desiredCF = CFrame.new(camCF.Position, target.Position)

				Camera.CFrame = camCF:Lerp(desiredCF, SMOOTHNESS)
			end)
		end
	else
		-- Disable AIM Disfarçado
		print("AIM Disfarçado disabled")

		-- Disable FOV Circle
		if _G.AimFOVGui then
			_G.AimFOVGui:Destroy()
			_G.AimFOVGui = nil
		end

		-- Stop aim loop
		if _G.AIMDisfarcadoConnection then
			_G.AIMDisfarcadoConnection:Disconnect()
			_G.AIMDisfarcadoConnection = nil
		end
	end
end



-- Botão ESP abre aba ESP
espButton.MouseButton1Click:Connect(function()
	espTab.Visible = true
	perfilTab.Visible = false
	aimTab.Visible = false
	playerTab.Visible = false
	newAIMTab.Visible = false
end)

-- Botão Perfil abre aba Perfil
perfilButton.MouseButton1Click:Connect(function()
	espTab.Visible = false
	perfilTab.Visible = true
	aimTab.Visible = false
	playerTab.Visible = false
	newAIMTab.Visible = false
end)

-- Botão AIM abre aba AIM
aimButton.MouseButton1Click:Connect(function()
	espTab.Visible = false
	perfilTab.Visible = false
	aimTab.Visible = true
	playerTab.Visible = false
	newAIMTab.Visible = false
end)

-- Botão Player abre aba Player
playerButton.MouseButton1Click:Connect(function()
	espTab.Visible = false
	perfilTab.Visible = false
	aimTab.Visible = false
	playerTab.Visible = true
	newAIMTab.Visible = false
end)

-- Botão New AIM abre aba New AIM
newAIMButton.MouseButton1Click:Connect(function()
	espTab.Visible = false
	perfilTab.Visible = false
	aimTab.Visible = false
	playerTab.Visible = false
	newAIMTab.Visible = true
end)

-- ===== VARIÁVEIS =====
local selectedPlayer = nil
local selectedButton = nil

-- ===== TELEPORT =====
local function teleportToPlayer(target)
	if not target or target == localPlayer then return end
	if not target.Character or not localPlayer.Character then return end

	local myRoot = localPlayer.Character:FindFirstChild("HumanoidRootPart")
	local targetRoot = target.Character:FindFirstChild("HumanoidRootPart")

	if myRoot and targetRoot then
		myRoot.CFrame = targetRoot.CFrame * CFrame.new(0, 0, -3)
	end
end

teleportButton.MouseButton1Click:Connect(function()
	if selectedPlayer then
		teleportToPlayer(selectedPlayer)
	end
end)

-- ===== CRIAR BOTÃO =====
local function createPlayerButton(player)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(1, -4, 0, 36)
	btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
	btn.TextColor3 = Color3.new(1,1,1)
	btn.Font = Enum.Font.SourceSans
	btn.TextSize = 18
	btn.Parent = listFrame

	local c = Instance.new("UICorner", btn)
	c.CornerRadius = UDim.new(0,8)

	if player == localPlayer then
		btn.Text = player.Name .. " (Você)"
		btn.BackgroundColor3 = Color3.fromRGB(70,70,70)
		btn.AutoButtonColor = false
		return
	end

	btn.Text = player.Name

	btn.MouseButton1Click:Connect(function()
		if selectedButton then
			selectedButton.BackgroundColor3 = Color3.fromRGB(40,40,40)
		end

		selectedPlayer = player
		selectedButton = btn
		btn.BackgroundColor3 = Color3.fromRGB(128,0,128)
		searchButton.Text = "Selecionado: " .. player.Name
		listOpen = false
		playerListFrame.Visible = false
	end)
end

-- ===== ATUALIZAR LISTA =====
local function refreshPlayers()
	for _, v in pairs(listFrame:GetChildren()) do
		if v:IsA("TextButton") then
			v:Destroy()
		end
	end

	for _, player in pairs(Players:GetPlayers()) do
		createPlayerButton(player)
	end
end

task.wait(1)
refreshPlayers()

Players.PlayerAdded:Connect(refreshPlayers)
Players.PlayerRemoving:Connect(refreshPlayers)
