local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera

local localPlayer = Players.LocalPlayer

-- Cria uma mira no centro da tela
local ScreenGui = Instance.new("ScreenGui", localPlayer:WaitForChild("PlayerGui"))
ScreenGui.IgnoreGuiInset = true

local crosshair = Instance.new("Frame")
crosshair.Size = UDim2.new(0, 10, 0, 10)
crosshair.Position = UDim2.new(0.5, -5, 0.5, -5)
crosshair.AnchorPoint = Vector2.new(0.5, 0.5)
crosshair.BackgroundColor3 = Color3.new(1, 0, 0)
crosshair.BorderSizePixel = 0
crosshair.Parent = ScreenGui

-- Função para encontrar o player mais próximo da câmera
local function getClosestPlayer()
    local closestPlayer = nil
    local shortestDistance = math.huge

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= localPlayer and player.Character and player.Character:FindFirstChild("Humanoid") and player.Character:FindFirstChild("Head") then
            local humanoid = player.Character.Humanoid
            if humanoid.Health > 0 then
                local headPos = player.Character.Head.Position
                local screenPos, onScreen = Camera:WorldToViewportPoint(headPos)
                if onScreen then
                    local mousePos = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
                    local distance = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
                    if distance < shortestDistance then
                        shortestDistance = distance
                        closestPlayer = player
                    end
                end
            end
        end
    end

    return closestPlayer
end

-- Atualiza a mira todo frame
RunService.RenderStepped:Connect(function()
    local target = getClosestPlayer()
    if target and target.Character and target.Character:FindFirstChild("Head") then
        local headPos = target.Character.Head.Position
        local screenPos, onScreen = Camera:WorldToViewportPoint(headPos)
        if onScreen then
            -- Move a mira para a cabeça do player mais próximo
            crosshair.Position = UDim2.new(0, screenPos.X - crosshair.Size.X.Offset/2, 0, screenPos.Y - crosshair.Size.Y.Offset/2)
        end
    else
        -- Se não houver alvo, a mira fica no centro
        crosshair.Position = UDim2.new(0.5, -5, 0.5, -5)
    end
end)
