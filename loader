local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- GUI
local gui = Instance.new("ScreenGui")
gui.Name = "PlayerListMenu"
gui.ResetOnSpawn = false
gui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Janela
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 260, 0, 320)
frame.Position = UDim2.new(0.02, 0, 0.5, -160)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BorderSizePixel = 0
frame.Parent = gui

local corner = Instance.new("UICorner", frame)
corner.CornerRadius = UDim.new(0, 12)

-- Título
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.BackgroundTransparency = 1
title.Text = "Players da Partida"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 20
title.Parent = frame

-- Área da lista
local listFrame = Instance.new("ScrollingFrame")
listFrame.Size = UDim2.new(1, -10, 1, -50)
listFrame.Position = UDim2.new(0, 5, 0, 45)
listFrame.CanvasSize = UDim2.new(0,0,0,0)
listFrame.ScrollBarImageTransparency = 0.3
listFrame.BackgroundTransparency = 1
listFrame.Parent = frame

local layout = Instance.new("UIListLayout", listFrame)
layout.Padding = UDim.new(0, 6)

layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	listFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 5)
end)

-- Função de teleport
local function teleportToPlayer(target)
	if target == LocalPlayer then return end
	if not target.Character or not LocalPlayer.Character then return end

	local myRoot = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
	local targetRoot = target.Character:FindFirstChild("HumanoidRootPart")

	if myRoot and targetRoot then
		myRoot.CFrame = targetRoot.CFrame * CFrame.new(0, 0, -3)
	end
end

-- Criar botão
local function createButton(player)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(1, -4, 0, 36)
	btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	btn.TextColor3 = Color3.new(1,1,1)
	btn.Font = Enum.Font.SourceSans
	btn.TextSize = 18
	btn.Parent = listFrame

	local c = Instance.new("UICorner", btn)
	c.CornerRadius = UDim.new(0, 8)

	if player == LocalPlayer then
		btn.Text = player.Name .. " (Você)"
		btn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
	else
		btn.Text = player.Name
		btn.MouseButton1Click:Connect(function()
			teleportToPlayer(player)
		end)
	end
end

-- Atualizar lista
local function refreshPlayers()
	for _, v in pairs(listFrame:GetChildren()) do
		if v:IsA("TextButton") then
			v:Destroy()
		end
	end

	for _, player in pairs(Players:GetPlayers()) do
		createButton(player)
	end
end

-- Inicialização
task.wait(1)
refreshPlayers()

Players.PlayerAdded:Connect(refreshPlayers)
Players.PlayerRemoving:Connect(refreshPlayers)
